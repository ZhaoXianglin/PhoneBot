<template>
  <div id="step1">
    <van-nav-bar title="Tips"/>
    <van-steps :active="1">
      <van-step>STEP1</van-step>
      <van-step>STEP2</van-step>
      <van-step>STEP3</van-step>
      <van-step>STEP4</van-step>
      <van-step>STEP5</van-step>
    </van-steps>
    <div id="main">
      <van-image
          round
          v-animate-css.once="animationInfinite0"
          width="10rem"
          height="10rem"
          :src="require('../assets/images/guide/person2.png')"
      />
      <typical
          v-if="lang==='s_cn'"
          class="typicalWrapper"
          :steps="type_content_s"
          v-animate-css.once="animationInfinite0"
          :wrapper="'h2'"
      ></typical>
      <typical
          v-else
          class="typicalWrapper"
          :steps="type_content_t"
          v-animate-css.once="animationInfinite0"
          :wrapper="'h2'"
      ></typical>
      <ol v-if="lang==='s_cn'">
        <li class="card" v-animate-css.once="animationInfinite1">1. ä¸€äº›æ‚¨çš„èƒŒæ™¯ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šæ€§åˆ«ã€‚</li>
        <li class="card" v-animate-css.once="animationInfinite2">2. ä¸€äº›å…³äºâ€œç†¬å¤œâ€çš„é™ˆè¿°æ˜¯å¦æ­£ç¡®ã€‚</li>
        <li class="card" v-animate-css.once="animationInfinite3">3. ä¸€äº›æ‚¨çš„ä¸ªäººç‰¹ç‚¹ã€‚</li>
      </ol>
      <ol v-else>
        <li class="card" v-animate-css.once="animationInfinite1">1. ä¸€äº›æ‚¨çš„èƒŒæ™¯ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šæ€§åˆ¥ã€‚</li>
        <li class="card" v-animate-css.once="animationInfinite2">2. ä¸€äº›é—œæ–¼ã€Œæ±å¤œã€çš„é™³è¿°æ˜¯å¦æ­£ç¢ºã€‚</li>
        <li class="card" v-animate-css.once="animationInfinite3">3. ä¸€äº›æ‚¨çš„å€‹äººç‰¹é»ã€‚</li>
      </ol>
      <div style="margin: 24px 16px;padding-bottom:48px">
        <van-button v-if="lang==='s_cn'" round block v-animate-css.once="animationInfinite4" type="info"
                    native-type="submit"
                    :loading="loading" @click="next">è®©æˆ‘ä»¬å¼€å§‹å§ï¼
        </van-button>
        <van-button v-else round block v-animate-css.once="animationInfinite4" type="info" native-type="submit"
                    :loading="loading" @click="next">è®“æˆ‘å€‘é–‹å§‹å§ï¼
        </van-button>
      </div>
    </div>
  </div>
</template>

<script>
import typical from "vue-typical";
import {instance} from "@/request";

export default {
  name: "Step1",
  components: {
    typical,
  },
  data: function () {
    return {
      lang: localStorage.getItem("lang"),
      loading: false,
      type_content_t: [
        '', 1500,
        'Hello!', 500,
        'Hello! æ­¡è¿é€²å…¥æˆ‘å€‘çš„å¯¦é©—ã€‚', 1000,
        'æ‚¨æ˜¯å¦æœ‰æ±å¤œçš„ç¿’æ…£ï¼ŸğŸ˜´', 1000,
        'æ‚¨æ˜¯å¦æœ‰æ±å¤œçš„ç¿’æ…£ï¼ŸğŸ˜´ æ‚¨èªç‚ºæ±å¤œæœ‰å“ªäº›å±å®³? ', 1500,
        'æ‚¨æ˜¯å¦æœ‰æ±å¤œçš„ç¿’æ…£ï¼ŸğŸ˜´ æ‚¨èªç‚ºæ±å¤œæœ‰å“ªäº›å±å®³? åœ¨æ¥ä¸‹ä¾†çš„å•å·ä¸­ï¼Œæˆ‘å€‘æœƒå•æ‚¨é€™æ¨£ä¸€äº›å•é¡Œï¼š', 1000,
      ],
      type_content_s: ['', 1500,
        'Hello!', 500,
        'Hello! æ¬¢è¿è¿›å…¥æˆ‘ä»¬çš„å®éªŒã€‚', 1000,
        'æ‚¨æ˜¯å¦æœ‰ç†¬å¤œçš„ä¹ æƒ¯ï¼ŸğŸ˜´', 1000,
        'æ‚¨æ˜¯å¦æœ‰ç†¬å¤œçš„ä¹ æƒ¯ï¼ŸğŸ˜´ æ‚¨è®¤ä¸ºç†¬å¤œæœ‰å“ªäº›å±å®³? ', 1500,
        'æ‚¨æ˜¯å¦æœ‰ç†¬å¤œçš„ä¹ æƒ¯ï¼ŸğŸ˜´ æ‚¨è®¤ä¸ºç†¬å¤œæœ‰å“ªäº›å±å®³? åœ¨æ¥ä¸‹æ¥çš„é—®å·ä¸­ï¼Œæˆ‘ä»¬ä¼šé—®æ‚¨è¿™æ ·ä¸€äº›é—®é¢˜ï¼š', 1000,
      ],
      animationInfinite0: {
        classes: 'fadeIn',
        delay: 1000,
        duration: 1000,
        iteration: 1
      },
      animationInfinite1: {
        classes: 'fadeIn',
        delay: 11000,
        duration: 1000,
        iteration: 1
      },
      animationInfinite2: {
        classes: 'fadeIn',
        delay: 12000,
        duration: 1000,
        iteration: 1
      },
      animationInfinite3: {
        classes: 'fadeIn',
        delay: 13000,
        duration: 1000,
        iteration: 1
      },
      animationInfinite4: {
        classes: 'fadeIn',
        delay: 14500,
        duration: 2000,
        iteration: 1
      },
    }
  },

  methods: {
    next: function () {
      this.loading = true;
      instance.post('/api/tip1', {
        'uuid': localStorage.getItem("uuid"),
        'tip1T': new Date().getTime(),
      }).then((res) => {
        if (res.data.status === 1) {
          localStorage.setItem("active", new Date().getTime().toString());
          this.$router.replace('/demographic').catch((err) => {
            console.log(err.message)
          });
          this.loading = false;
        } else {
          this.loading = false;
          this.$toast("Please refresh this page or accept the informed consent statement first.")
        }
      }).catch((err) => {
        this.loading = false;
        console.log(err.message);
        this.$toast("Network error, please try again later.");
      })
    },
  }
};
</script>

<style scoped>
#main {
  font-family: "Avenir", Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
  background-color: white;
  padding: 30px 10px 20px 10px;
}

.card {
  text-align: center;
  padding: 20px 10px;
  margin-bottom: 5px;
  font-size: 1.4em;
  border-radius: 4px;
  border: 1px solid #ebeef5;
  background-color: #fff;
  overflow: hidden;
  color: #2c3e50;
  transition: .3s;
  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, .1);
}

.typicalWrapper::after {
  content: "|";
  animation: blink 1s infinite step-start;
}

@keyframes blink {
  50% {
    opacity: 0;
  }
}
</style>
